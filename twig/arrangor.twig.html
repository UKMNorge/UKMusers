{% extends "layout.twig.html" %}

{% block content %}
<div class="UKMwidth">
	<h3>Arrangør-brukere</h3>
	<p class="lead">Alle arrangør- og scenetekniker-deltakere får automatisk bruker.<br /> Ingen blir varslet om dette, så arrangøren må selv distribuere passordene</p>
	
	<div class="alert alert-danger">
		<div class="col-xs-6">
			<h4>Arrangør-brukere</h4>
			<p>Arrangørbrukerne har full tilgang til arrangørsystemet, på lik linje med lokalkontakten.</p>
			<p><b>OBS:</b> Arrangørbrukerne har også tilgang til denne modulen, og kan oppgradere andre arrangører</p>
		</div>
		<div class="col-xs-6">
			<h4>Rapportbrukere</h4>
			<p>Rapportbrukerne har tilgang til rapport-, materiell- og playbackmodulen.</p>
		</div>
		<div class="clearfix"></div>
	</div>
	
	<table class="table table-striped">
		{% for user in users %}
			<tr>
				<td class="col-xs-12 col-sm-4 col-md-4">
					<h5>{{ user.first_name }} {{ user.last_name }}</h5>
					{% if user.role == 'editor' %}
						<p class="label label-danger">Arrangør</p>
					{% else %}
						<p class="label label-success">Rapport-bruker</p>
					{% endif %}
				</td>
				<td class="col-xs-12 col-sm-4 col-md-4">
					<strong>{{ user.username }}</strong>
					<br />
					{{ user.password }}
				</td>
				<td class="col-sm-4 col-md-4" align="right">
					<button class="btn dropdown-toggle btn-md btn-default" type="button" id="actionsUser_{{ user.wp_id }}" data-toggle="dropdown" aria-expanded="true">
						Handlinger
						<span class="caret"></span>
					</button>
					<ul class="dropdown-menu" role="menu" aria-labelledby="actionsUser_{{ user.wp_id }}">
						{% if user.role == 'editor' %}
							<li role="presentation">
								<a href="?page=UKMusers&action=arrangor&downgrade={{ user.wp_id }}">Nedgrader til rapportbruker</a>
							</li>
						{% else %}
							<li role="presentation">
								<a href="?page=UKMusers&action=arrangor&upgrade={{ user.wp_id }}">Oppgrader til arrangør-bruker</a>
							</li>
						{% endif %}
					</ul>
				</td>
			</tr>
		{% else %}
		<tr class="alert alert-info">
			<td>
				<h4>Det er ikke lagt til noen arrangørbrukere enda.</h4>
				<p>
					Kan det være fordi du ikke har noen påmeldte til arrangør eller sceneteknikk?
					Hvis du har påmeldte men ingen brukere, <a href="mailto:support@ukm.no">kontakt support</a>
				</p>
			</td>
		</tr>
		{% endfor %}
	</table>
	{% if errors is not null %}
		<h4>Følgende feil oppstod: </h4>
		<p>Kontakt support med informasjonen under for hjelp.</p>
		{% for error_arr in errors %}
			{% for error_sub_arr in error_arr %}
				{% for level, error in error_sub_arr %}
					<div class="alert alert-{{ level }}">{{ error }}</div>
				{% endfor %}
			{% endfor %}
		{% endfor %}
		{% if is_super_admin %}
			<div class="alert alert-info">
				For å fikse brukere med feil (røde bokser nederst i listen), finn brukeren i ukm_wp_deltakerbrukere basert på e-post eller brukernavn. Oppdater p_id i databasen til den nye p_id'en som står i boksen, og oppdater siden.
			</div>
		{% endif %}
	{% endif %}
</div>
{% endblock %}